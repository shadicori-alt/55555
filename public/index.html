<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>بسم الله</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <style>
    body { background: linear-gradient(135deg, #667eea, #764ba2); font-family: 'Cairo', sans-serif; min-height: 100vh; }
    .navbar { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
    .card { border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); background: white; }
    .nav-link.active { color: #1E40AF !important; border-bottom: 3px solid #1E40AF; }
    .page { display: none; }
    .page.active { display: block; }
  </style>
</head>
<body class="p-3">

  <!-- تسجيل الدخول -->
  <div id="login" class="container mt-5">
    <div class="card p-4 mx-auto" style="max-width: 400px;">
      <h3 class="text-center">بسم الله</h3>
      <input id="username" class="form-control mb-3" placeholder="اسم المستخدم" value="admin">
      <input id="password" class="form-control mb-3" type="password" placeholder="كلمة السر" value="1234">
      <button class="btn btn-primary w-100" onclick="login()">دخول</button>
    </div>
  </div>

  <!-- النظام -->
  <div id="app" style="display: none;">
    <nav class="navbar navbar-expand-lg mb-4 p-3">
      <div class="container-fluid">
        <a class="navbar-brand fw-bold text-primary">بسم الله</a>
        <div class="navbar-nav gap-2">
          <a class="nav-link active" data-page="links">الارتباطات</a>
          <a class="nav-link" data-page="orders">الطلبات</a>
          <a class="nav-link" data-page="agents">المناديب</a>
          <a class="nav-link" data-page="accounts">الحسابات</a>
          <a class="nav-link" data-page="workflow">سير العمل</a>
        </div>
      </div>
    </nav>

    <!-- 1. الارتباطات -->
    <div id="links" class="page active card p-4">
      <h5>الارتباطات</h5>
      <div class="border p-3 rounded mb-3">
        <div class="d-flex justify-content-between">
          <div><strong>فيسبوك</strong> <span id="fb-status" class="badge bg-secondary ms-2">غير متصل</span></div>
          <button id="fb-connect" class="btn btn-primary btn-sm">تسجيل الدخول</button>
        </div>
      </div>
      <div class="border p-3 rounded mb-3">
        <div class="row g-2">
          <div class="col-md-6"><input id="twilio-sid" class="form-control form-control-sm" placeholder="Twilio SID"></div>
          <div class="col-md-6"><input id="twilio-token" class="form-control form-control-sm" type="password" placeholder="Token"></div>
          <div class="col-12"><button class="btn btn-success btn-sm w-100" onclick="saveTwilio()">حفظ</button></div>
        </div>
      </div>
    </div>

    <!-- 2. الطلبات -->
    <div id="orders" class="page card p-4">
      <div class="d-flex justify-content-between mb-3">
        <h5>الطلبات</h5>
        <button class="btn btn-primary" onclick="addOrder()">+ طلب جديد</button>
      </div>
      <div id="orders-list"></div>
    </div>

    <!-- 3. المناديب -->
    <div id="agents" class="page card p-4">
      <div class="d-flex justify-content-between mb-3">
        <h5>المناديب</h5>
        <button class="btn btn-success" onclick="addAgent()">+ مندوب جديد</button>
      </div>
      <div id="agents-list" class="row g-3"></div>
    </div>

    <!-- 4. الحسابات -->
    <div id="accounts" class="page card p-4">
      <h5>الحسابات اليومية</h5>
      <div class="row g-3">
        <div class="col-md-4"><div class="card p-3 text-center bg-primary text-white"><h4 id="today-total">0</h4><p>إجمالي</p></div></div>
        <div class="col-md-4"><div class="card p-3 text-center bg-success text-white"><h4 id="today-cash">0</h4><p>نقدي</p></div></div>
        <div class="col-md-4"><div class="card p-3 text-center bg-info text-white"><h4 id="today-vodafone">0</h4><p>فودافون</p></div></div>
      </div>
    </div>

    <!-- 5. سير العمل -->
    <div id="workflow" class="page card p-4">
      <h5 class="text-center">خط سير العمل</h5>
      <div class="row g-3 text-center">
        <div class="col-3"><button id="step-page" class="btn btn-sm btn-outline-primary w-100" onclick="toggleStep('page')">تشغيل</button></div>
        <div class="col-3"><button id="step-order" class="btn btn-sm btn-outline-primary w-100" onclick="toggleStep('order')">تشغيل</button></div>
        <div class="col-3"><button id="step-dist" class="btn btn-sm btn-outline-primary w-100" onclick="toggleStep('dist')">تشغيل</button></div>
        <div class="col-3"><button id="step-close" class="btn btn-sm btn-outline-primary w-100" onclick="toggleStep('close')">تشغيل</button></div>
      </div>
      <button class="btn btn-danger w-100 mt-4" onclick="stopAll()">إيقاف السير كله</button>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>